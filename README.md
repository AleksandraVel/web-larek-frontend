https://github.com/AleksandraVel/web-larek-frontend.git

# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/Pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

# Архитектура проекта

## Проект использует паттерн MVP (Model-View-Presenter) для разделения ответственностей между классами:

- Данные (Model):
 Класс AppState отвечает за хранение и управление данными приложения.
- Слой отображения (View):
 Классы Component, Model, Modal, Page, Card, Basket, Form, Order, Contacts и Success отвечают за отображение интерфейса для взаимодействия с пользователем.
- Presenter:
 Класс EventEmitter связывают Model и View, координируя их взаимодействие. 

# Описание интерфейса

- Просмотр каталога карточек товаров.
- Просмотр выбраной карточки товара.
- Оформление заказа. 

## Карточки товаров:
 
 Данные о товаре:
- Название
- Описание
- Цена
- Изображение

## Формы :
- форма оплаты (Способ оплаты)
- форма контактов (Адрес доставки, email, телефон)
- окно условной покупки (корзина)

# Описание базовых классов, их предназначение и функции

## class Api

Класс для работы с API. Отвечает за выполнение HTTP-запросов.
Предоставляет методы для получения, создания, обновления и удаления данных.

Свойства:
- baseUrl: string : Строка, содержащая базовый URL-адрес для API.
- options: RequestInit: Объект RequestInit, содержащий дополнительные опции для запросов, такие как заголовки.

Методы:
- constructor(baseUrl: string, options: RequestInit = {}): Создает экземпляр класса с заданным базовым URL-адресом и дополнительными опциями для запросов.
- protected async handleResponse(response: Response): Promise<Partial<object>>: Обрабатывает ответ от API.
- async get(uri: string): Promise<object>: Выполняет GET-запрос к API по указанному URI и возвращает Promise с данными в формате объекта.
- async post(uri: string, data: object): Promise<object> : Выполняет POST-запрос к API по указанному URI с переданными данными и возвращает Promise с данными в формате объекта.

## class EventEmitter (Presenter)
Класс EventEmitter обеспечивает гибкую связь между различными компонентами системы без жесткой зависимости.

Mетоды:
- on: Подписывает обработчик на событие. Обработчик будет вызван каждый раз, когда событие инициируется.
- off: Отписывает обработчик от события. Обработчик больше не будет вызываться при инициации события.
- emit: Инициирует событие и вызывает все подписанные на него обработчики, передавая им данные события.

## class AppState (Model)

Класс AppState отвечает за хранение и управление состоянием приложения, включая товары в корзине и данные заказа. Он также отвечает за валидацию данных форм и генерацию событий при изменении данных.

Свойства:
- basket: Product[]: массив товаров в корзине.
- store: Product[]: массив со всеми товарами.
- order: IOrder: объект заказа клиента.
- formErrors: FormErrors: объект с ошибками валидации форм.

Методы:
- addToBasket(product: Product): void: добавляет товар в корзину
- deleteFromBasket(id: string): void: удаляет товар из корзины
- clearBasket(): void: очищает корзину.
- getBasketAmount(): number: возвращает количество товаров в корзине.
- setItems(): void: устанавливает идентификаторы товаров в корзине как элементы заказа.
- setOrderField(field: keyof IOrderForm, value: string): void: устанавливает значение поля заказа и валидирует контактные данные и данные заказа.
- validateContacts(): boolean: проверяет контактные данные на валидность и возвращает результат проверки.
- validateOrder(): boolean: проверяет данные заказа на валидность и возвращает результат проверки.
- refreshOrder(): void: обновляет данные заказа, сбрасывая их в начальное состояние.
- getTotalBasketPrice(): number: возвращает общую стоимость товаров в корзине.
- setStore(items: IProduct[]): void: устанавливает товары магазина и инициирует событие об изменении товаров.
- resetSelected(): void: сбрасывает выбор товаров в магазине.

## class Product

Класс Product представляет данные о товаре и наследуется от класса Model.

Свойства:
- id: string - уникальный идентификатор товара.
- description: string - описание товара.
- image: string - ссылка на изображение товара.
- title: string - название товара.
- category: string - категория товара.
- price: number | null - цена товара, может быть null, если цена не указана.
- selected: boolean - флаг, указывающий, выбран ли товар.

## class Component<T>

Класс Component является абстрактным базовым компонентом, от которого наследуются все остальные компоненты в проекте. Он содержит общие методы для работы с DOM и предоставляет инструменты для управления отображением интерфейса.

Методы:
- protected constructor(protected readonly container: HTMLElement): Принимает контейнер (DOM-элемент), в котором будет отображаться компонент.
- toggleClass(element: HTMLElement, className: string, force?: boolean): Переключает класс у указанного элемента.
- setText(element: HTMLElement, value: unknown): Устанавливает текстовое содержимое указанного элемента.
- setDisabled(element: HTMLElement, state: boolean): Устанавливает или снимает блокировку для указанного элемента.
- setHidden(element: HTMLElement): Скрывает указанный элемент.
- setVisible(element: HTMLElement): Показывает указанный элемент.
- setImage(element: HTMLImageElement, src: string, alt?: string): Устанавливает изображение с альтернативным текстом для указанного элемента.
- render(data?: Partial<T>): HTMLElement: Возвращает корневой DOM-элемент компонента с возможностью обновления данных.

## class Model<T>

Класс Model является базовой моделью и предазначен для отличия ее от простых объектов данных. 

Методы:

- constructor: Создает экземпляра с указанными данными и объектом для управления событиями.
- emitChanges(event: string, payload?: object): Генерирует указанное событие и передает дополнительные данные.

## class Modal (Component)

Класс Modal расширяет функциональность базового класса Component и отвечает за управление модальным окном в вашем приложении. Он предоставляет методы для открытия и закрытия модального окна, а также для установки содержимого.

Методы:
- constructor(container: HTMLElement, events: IEvents): Создает экземпляр класса Modal с заданным контейнером модального окна и объектом событий. Конструктор инициализирует кнопку закрытия и контент модального окна, а также связывает события для управления поведением модального окна.
- set content(value: HTMLElement): Сеттер, который заменяет текущее содержимое модального окна на новый HTML-элемент.
- open(): Метод для открытия модального окна. 
- close(): Метод для закрытия модального окна. 
- render(data: IModalData): HTMLElement: Метод для рендеринга модального окна. Вызывает метод open для отображения модального окна с переданными данными.

## class Page (View)

Класс Page представляет собой главную страницу приложения - галерею товаров.

Методы:
- constructor(container: HTMLElement, events: IEvents): Создает экземпляр класса с заданным контейнером и обработчиком событий.
- set counter(value: number): Устанавливает количество товаров в корзине.
- set store(items: HTMLElement[]): Заменяет дочерние элементы галереи на новые карточки товаров.
- set locked(value: boolean): Блокирует или разблокирует прокрутку страницы.

## class Card (View)

Класс Card представляет собой карточку товара в галерее.
Отвечает за отображение информации о товаре.

Свойства:
- _title: HTMLElement - элемент для отображения названия товара.
- _image: HTMLImageElement - элемент для отображения изображения товара.
- _category: HTMLElement - элемент для отображения категории товара.
- _price: HTMLElement - элемент для отображения цены товара.
- _button: HTMLButtonElement - кнопка для взаимодействия с товаром.

Методы:
- constructor(blockName: string, container: HTMLElement, actions?: ICardActions): Создает экземпляр класса с заданным именем блока, родительским контейнером и объектом с колбэк функциями.
- set id(value: string): Устанавливает уникальный идентификатор товара.
- get id(): Возвращает уникальный идентификатор товара.
- set title(value: string): Устанавливает название товара.
- get title(): Возвращает название товара.
- set image(value: string): Устанавливает изображение товара.
- set selected(value: boolean): Определяет, выбран ли товар.
- set price(value: number | null): Устанавливает цену товара.
- set category(value: CategoryType): Устанавливает категорию товара.

### class StoreItem (Card)

Класс StoreItem расширяет класс Card. Предназначен для создания элемента магазина.

Конструктор:
- container: HTML-элемент, в который будет помещен элемент магазина.
- actions: необязательный параметр, представляющий действия, связанные с карточкой.

Методы:
- Конструктор StoreItem вызывает конструктор базового класса Card, передавая ему тип карточки, контейнер и действия.

### class StoreItemPreview (Card)

Класс StoreItemPreview также расширяет класс Card. Предназначен для создания предварительного просмотра элемента магазина с описанием.

Конструктор:
- container: HTML-элемент, в который будет помещен предварительный просмотр элемента магазина.
- actions: необязательный параметр, представляющий действия, связанные с карточкой.

Свойства:
- _description: защищенное свойство, содержащее HTML-элемент для текста описания.

Методы:
- Конструктор StoreItemPreview вызывает конструктор базового класса Card, передавая ему тип карточки, контейнер и действия. Также инициализирует свойство _description.
- Сеттер description позволяет установить текст описания для элемента _description.

## class Basket (View)

Класс Basket расширяет базовый класс Component и управляет отображением корзины товаров в приложении. Он позволяет добавлять товары в корзину, удалять их и обновлять общую стоимость.

Методы:
- constructor(blockName: string, container: HTMLElement, events: IEvents): Создает экземпляр класса Basket с заданным именем блока, контейнером и объектом событий.
- set price(price: number): Сеттер, который отображает общую стоимость товаров в корзине в 'синапсах'.
- set list(items: HTMLElement[]): Сеттер для списка товаров.
- disableButton(): Метод, который отключает кнопку 'Оформить'.
- refreshIndices(): Метод, который обновляет индексы товаров в корзине после удаления одного из них.

## class Form<T> (View)

Класс Form расширяет класс Componentи отвечает за управление формой на странице. Он содержит методы для обработки ввода данных и отправки формы, а также валидации и отображения ошибок.
  
Свойства:
- _submit: HTMLButtonElement - кнопка отправки формы.
- _errors: HTMLElement - элемент для отображения сообщений об ошибках.
- container: HTMLFormElement - DOM-элемент формы.
- events: IEvents - объект для работы с событиями формы.

Методы:
- constructor(container: HTMLFormElement, events: IEvents): Создает экземпляр класса с заданным DOM-элементом формы и объектом для работы с событиями.
- onInputChange(field: keyof T, value: string): Обрабатывает изменение значения поля формы и инициирует соответствующее событие.
- set valid(value: boolean): Устанавливает состояние валидности формы, активируя или деактивируя кнопку отправки.
- set errors(value: string): Устанавливает текст ошибки для формы.
- render(state: Partial<T> & IFormState): Обновляет состояние формы и отображает ее на странице.


### class Order (Form)

Класс Order отвечает за отображение формы для оформления заказа товара. Он расширяет функциональность базового класса Form и содержит методы для создания формы выбора способа оплаты и ввода адреса доставки.

Методы:
- constructor(blockName: string, container: HTMLFormElement, events: IEvents): Создает экземпляр класса с заданным именем блока, контейнером формы заказа и объектом для работы с событиями.
- disableButtons(): Отключает подсветку активных кнопок выбора способа оплаты.
- onInputChange(name: keyof IOrder, value: string): Обрабатывает изменения в полях ввода формы и обновляет состояние класса.


### class Contacts (Form)

Класс Contacts наследует функциональность от базового класса Form и управляет формой контактных данных пользователя, таких как email и телефон.

Методы:
- constructor(container: HTMLFormElement, events: IEvents): Создает экземпляр класса Contacts с заданным DOM-элементом формы и объектом событий.

## class Success (View)

Класс Success отвечает за отображение окна с сообщением об успешном оформлении заказа.Он расширяет базовый класс Component.

Свойства:
- _button: HTMLButtonElement`: Защищенное свойство, содержащее кнопку для закрытия сообщения.
- _description: HTMLElement`: Защищенное свойство, содержащее элемент для отображения описания действия.

Методы:
- constructor: Создает экземпляр класса с заданным именем блока, контейнером и действиями. Инициализирует кнопку закрытия и элемент описания, а также назначает обработчик события клика.
- set description(value: number): Сеттер, который устанавливает текст описания, преобразуя числовое значение в форматированную строку с использованием функции handlePrice и добавляет единицы измерения 'синапсов'.